---
title: "MA0501 – Tarea 2"
author: 
  - name: "Diego Alberto Vega Víquez - C38367" 
    email: "diegovv13@gmail.com"
  - name: "José Carlos Quintero Cedeño - C26152" 
    email: "jose.quinterocedeno@ucr.ac.cr"
  - name: "Gabriel Valverde Guzmán - C38060"
    email: "GABRIEL.VALVERDEGUZMAN@ucr.ac.cr"
date: today
lang: es
format:
  pdf:
    documentclass: article
    fontsize: 11pt
    linestretch: 1.3
    geometry:
      - top=2.5cm
      - bottom=2.5cm
      - left=2.5cm
      - right=2.5cm
      - headheight=15pt
      - footskip=1.25cm
    toc: true
    toc-depth: 1
    number-sections: false
    classoption:
      - oneside
      - titlepage 
    openany: true
    colorlinks: false   
    top-level-division: section
    include-in-header: 
      text: |
        \usepackage[most]{tcolorbox}
        \usepackage[hidelinks]{hyperref}
        \usepackage{setspace}
        \AtBeginDocument{\setstretch{1.0}} % ← interlineado
  html:
    code-annotations: hover
    toc: true
    toc-depth: 1
    toc-location: left
    toc_float: yes
    html-math-method: katex
    css: styles.css
    df_print: paged
    theme: flatly
    highlight: tango
---

\newpage

# Ejercicio 1
::: {.callout-note}
## Instrucción

Suponga que $p^*$ aproxima a $p$ con 3 dígitos significativos.  
Encuentre el intervalo en el cual $p^*$ debe estar, si:

a) $\quad p = 150$  
b) $\quad p = 900$  
c) $\quad p = 1500$  
d) $\quad p = 90$  

:::

## Solución

Vea que si $P^*$ aproxima a $P$ con 3 dígitos significativos eso significa que 

\begin{align*}
\frac{|P - P^*|}{|P|} &< 0.5 \times 10^{-t+1} \\[1ex]
|P - P^*| &< 0.5 \times 10^{-t+1}\,|P| \\[1ex]
P - 0.5 \times 10^{-t+1}\,|P| &< P^* < P + 0.5 \times 10^{-t+1}\,|P|
\end{align*}

Por lo que se puede concluir que el intervalo en el cual $p*$ debe estar es

$$
](1 - 0.5 \times 10^{-t+1})\,|P|, (1 + 0.5 \times 10^{-t+1})\,|P|[
$$
```{r}
#| code-fold: true
t <- 3 #<1>

intervalo <- function(P, t) { #<2>
  margen <- 0.5 * 10^(-t + 1)
  inferior <- P * (1 - margen)
  superior <- P * (1 + margen)
  data.frame(
    P = P,
    t = t,
    Limite_Inferior = round(inferior, 4),
    Limite_Superior = round(superior, 4)
  )
}

tabla_intervalos <- rbind( #<3>
  intervalo(150, t),
  intervalo(900, t),
  intervalo(1500, t),
  intervalo(90, t)
)

kableExtra::kable(tabla_intervalos) #<4>
```
1. Definir el valor de t
2. Función que devuelve los extremos del intervalo como fila de una tabla
3. Crear tabla con los resultados para varios valores de P
4. Mostrar la tabla (Quarto renderiza automáticamente como tabla bonita)


# Ejercicio 2
::: {.callout-note}
## Instrucción

Considere los siguientes valores para $p$ y $p^*$:

a. $\quad p = \pi\qquad p^* = 3.1$  
b. $\quad p = \tfrac{1}{3}\qquad p^* = 0.333$  
c. $\quad p = \tfrac{\pi}{1000}\qquad p^* = 0.0031$  
d. $\quad p = \tfrac{100}{3}\qquad p^* = 33.3$  

¿Cuál es el error absoluto y relativo al aproximar $p$ por $p^*$?

:::

## Solución


# Ejercicio 3
::: {.callout-note}
## Instrucción

Sea 
$$
\alpha_n = \frac{n+10}{n^5},
$$
pruebe que
$$
\alpha_n = 0 + O\!\left(\frac{1}{n^4}\right).
$$

¿Qué se puede concluir?

:::

## Solución


# Ejercicio 4
::: {.callout-note}
## Instrucción

Suponga que ${fl}(x)$ es una aproximación de $x$ con redondeo a $k$ dígitos.  
Demuestre que:

$$
\left| \frac{x - {fl}(x)}{x} \right| \leq 0.5 \times 10^{-k+1}.
$$

:::

## Solución

Ya que ${fl}(x)$ es una aproximación de $x$ con redondeo a $k$ dígitos eso significa que podemos escribir ${fl}(x)$ de la siguiente forma

$${fl}(x) = 0.d_1 d_2 \cdots d_k \times 10^{n}$$

Sea $x\in\mathbb{R}$ que escribiremos como 

$$x=0.d_1 d_2 \cdots \times 10^{n}$$

De esta forma

\begin{align*}
\left| \frac{x - fl(x)}{x} \right|
&= \left| \frac{0.d_1 d_2 \cdots \times 10^n - 0.d_1 d_2 \cdots d_k \times 10^n}{0.d_1 d_2 \cdots \times 10^n} \right| \\[1ex]
&= \left| \frac{0.d_{k+1} d_{k+2} \cdots \times 10^{n-k}}{0.d_1 d_2 \cdots \times 10^n} \right| \\[1ex]
&= \left| \frac{0.d_{k+1} d_{k+2} \cdots}{0.d_1 d_2 \cdots} \right| \times 10^{-k} \\[1ex]
\end{align*}

Aquí hay que analizar por casos:

- Suponga que $d_{k+1} < 5$

En este caso basta con cortar en $d_k$ así:

\begin{align*}
\left| \frac{x - fl(x)}{x} \right|
&= \left| \frac{0.d_{k+1} d_{k+2} \cdots}{0.d_1 d_2 \cdots} \right| \times 10^{-k} \\[1ex]
&\leq 0.5\cdot\left| \frac{1}{0.1} \right| \times 10^{-k} \\[1ex]
&= 0.5\times 10^{-k+1}
\end{align*}

- Suponga que $d_{k+1} \ge 5$.

Recuerde que para este caso en ${fl}(x)$ pasa que $d_k$ es una unidad mayor que el $d_k$ de $x$. De esta forma se va a cumplir que $d_{j_\text{real}}$$=d_{j_\text{aproximado}}$ para $j=\{1,2,\ldots,k-1\}$ así se tiene que 

$$
|x - fl(x)| = 10^{1-k}\cdot(1-0.d_{k+1}\cdots)
$$
$$
\left| \frac{x - fl(x)}{x} \right| = \frac{10^{1-k}\cdot(1-0.d_{k+1}\cdots)}{|0.d_1 d_2 \cdots\times 10^{n}|}
$$
Vea que 
\begin{align*}
d_{k+1} \ge 5 &\implies 0.d_{k+1}\cdots\ge\frac{1}{2}\\
&\implies 1-0.d_{k+1}\cdots\le\frac{1}{2}\\
&\implies 1-0.d_{k+1}\cdots\le\frac{1}{2}
\end{align*}
Así
$$
\left| \frac{x - fl(x)}{x} \right| \le \frac{10^{1-k} \cdot 0.5}{|0.d_1 d_2 \cdots\times 10^{n}|} \le 10^{1-k} \cdot 0.5
$$
Luego, concluya que 
$$
\left| \frac{x - {fl}(x)}{x} \right| \leq 0.5 \times 10^{-k+1} \qquad \blacksquare
$$

# Ejercicio 5
::: {.callout-note}
## Instrucción

Si se calcula la raíz menor en valor absoluto de la ecuación:

$$
f(x) = x^2 + 0.4002 \times 10^0 x + 0.8 \times 10^{-4} = 0,
$$

con la fórmula cuadrática usual, entonces se produce una pérdida de dígitos significativos.  

¿Por qué?  

Encuentre una fórmula alternativa para efectuar este cálculo sin que se produzca tal pérdida y determine la raíz de menor magnitud.

:::

# Ejercicio 6
::: {.callout-note}
## Instrucción

Escriba una función en R que verifique, para cualquier $n$, la siguiente identidad:

$$
\begin{vmatrix}
x & a_1 & a_2 & \cdots & a_n \\
a_1 & x & a_2 & \cdots & a_n \\
a_1 & a_2 & x & \cdots & a_n \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
a_1 & a_2 & a_3 & \cdots & x
\end{vmatrix}
=
(x + a_1 + \cdots + a_n)(x-a_1)(x-a_2)\cdots(x-a_n).
$$


:::

## Solución

# Ejercicio 7
::: {.callout-note}
## Instrucción

Escriba una función en R que verifique para cualquier $n$ la siguiente identidad:

$$
\begin{vmatrix}
1 & 1 & 1 & \cdots & 1 & 1 \\
b_1 & a_1 & a_1 & \cdots & a_1 & a_1 \\
b_1 & b_2 & a_2 & \cdots & a_2 & a_2 \\
\vdots & \vdots & \vdots & \ddots & \ddots & \vdots \\
b_1 & b_2 & b_3 & \cdots & b_n & a_n
\end{vmatrix}
=
(a_1 - b_1)(a_2 - b_2)\cdots(a_n - b_n).
$$

:::

## Solución

```{r}
identidad <- function(df) {
  n <- ncol(df) - 1
  # Validaciones básicas
  if (nrow(df) != n + 1) return(FALSE)
  if (!all(df[1, ] == 1)) return(FALSE)
  M <- df[-1, ] #<1>
  a <- diag(M[, -1])
  b <- diag(M[, -ncol(M)])
  
  estructura_valida <- all( #<2>
    sapply(1:n, function(i) {
      fila <- M[i, ]
      izquierda <- fila[1:i]
      derecha <- fila[(i+1):(n+1)]
      all(izquierda == b[i]) && all(derecha == a[i])
    })
  )
  if (!estructura_valida) return(FALSE)
  return(isTRUE(all.equal(det(df), prod(a - b)))) #<3> 
}

```
1. Extraer submatriz sin la primera fila
2. Verificar estructura: por filas, los valores deben seguir patrón
3. Validar identidad con tolerancia numérica


### Prueba
```{r}
df <- matrix(c(
  1, 1, 1, 1,
  2, 3, 3, 3,
  2, 2, 4, 4,
  2, 2, 2, 5
), nrow = 4, byrow = TRUE)

identidad(df)
```



---

# Ejercicio 8
::: {.callout-note}
## Instrucción

Se dice que una matriz es *rala* si esta tiene más entradas nulas que no nulas (mayor estricto).  
Escriba una función en R que permita determinar si una matriz es rala.

:::

## Solución

---

# Ejercicio 9
::: {.callout-note}
## Instrucción

Se dice que una matriz $A \in M_{n \times m}$ tiene *forma de O* si todas las entradas de la fila 1, fila $n$, columna 1 y columna $m$ no son nulas, y las demás entradas de la matriz son nulas.  
Escriba una función en R que permita determinar si una matriz está en forma de O.

:::

## Solución

---

# Ejercicio 10
::: {.callout-note}
## Instrucción

En el capítulo de análisis funcional complete las demostraciones de los teoremas 2, 4, 5, 14, 16 y de los ejemplos 3, 5.

:::

## Solución

::: {.callout-tip}
## Teorema 2
En un espacio vectorial de dimensión finita todas las normas son equivalentes.  

::: {.callout-caution collapse="true"}
### Prueba

$\blacksquare$
:::
:::

---

::: {.callout-tip}
## Teorema 4
Para todo producto interno se tiene la desigualdad de Cauchy–Schwarz:

$$|\langle x, y \rangle|^2 \leq \langle x, x \rangle \langle y, y \rangle,$$

para todo $x, y \in X$, además se tiene igualdad si para todo $x, y$ son linealmente dependientes.  

::: {.callout-caution collapse="true"}
### Prueba

Si $x = 0$ la desigualdad es trivial. Si $x \neq 0$, tome  

$$z = y - \frac{\langle y, x \rangle}{\|x\|^2} x,$$

luego es claro que $\langle z, x \rangle = 0$ y que:

$$
0 \leq \|z\|^2 
= \left\langle y - \frac{\langle y, x \rangle}{\|x\|^2}x , \, y - \frac{\langle y, x \rangle}{\|x\|^2}x \right\rangle
= \langle y, y \rangle - \frac{\langle y, x \rangle \langle x, y \rangle}{\|x\|^2}
= \|y\|^2 - \frac{|\langle x, y \rangle|^2}{\|x\|^2}.
$$

De donde se tiene la desigualdad. Además se tiene igualdad si para todo $x, y$ son linealmente dependientes (ejercicio).  

$\blacksquare$
:::
:::

---

::: {.callout-tip}
## Teorema 5
Sea $X$ un espacio vectorial complejo (o real). Entonces la función  

$$
\|x\| := \langle x, x \rangle^{1/2}
$$

define una norma en $X$, es decir un espacio pre–Hilbert es siempre un espacio normado.  

::: {.callout-caution collapse="true"}
### Prueba

Sea $X$ un espacio pre–Hilbert, defina la función $\langle \cdot,\cdot \rangle : X \times X \to \mathbb{C}$ (o $\mathbb{R}$) y vea que para $x\in V$

 - $\langle x, x \rangle \geq 0 \implies \langle x, x \rangle^{1/2}\ge 0$
 - $\Big(\langle x, x \rangle = 0 \iff x = 0 \Big)\implies\Big( \langle x, x \rangle^{1/2} = 0 \iff x = 0 \Big)$
 - Sea $\alpha\in\mathbb{C}$ (o $\mathbb{R}$) entonces
 
 \begin{align*}
 \langle \alpha x, \alpha x \rangle^{1/2} &= \Big( \alpha\langle x, \alpha x \rangle\Big)^{1/2}\\
 &= \Big( \alpha\overline{\langle \alpha x, x \rangle}\Big)^{1/2}\\
  &= \Big( \alpha\cdot\overline{\alpha} \cdot {\langle x, x \rangle}\Big)^{1/2}\\
  &= \Big( |\alpha|^2 {\langle x, x \rangle}\Big)^{1/2}\\
 &=  |\alpha|\langle x, x \rangle^{1/2}\\
 \end{align*}
 
 - Sea $y \in V$ entonces
 
 \begin{align*}
  \langle x+y, x+y \rangle^{1/2} &= \Big(\langle x, x+y \rangle + \langle y, x+y \rangle\Big)^{1/2} \\
  &= \Big(\overline{\langle x+y, x \rangle} + \overline{\langle x+y, y \rangle}\Big)^{1/2} \\
&= \Big( \langle x,x \rangle + \langle x,y \rangle + \langle y,x \rangle + \langle y,y \rangle \Big)^{1/2}\\
&\le \Big( \langle x,x \rangle + 2\cdot \langle x, x \rangle^{1/2} \langle y, y \rangle^{1/2} + \langle y,y \rangle \Big)^{1/2}\\
\end{align*}

Esto último asumiendo que $\langle y,x \rangle = \overline{\langle y,x \rangle}$ y usando Cauchy–Schwarz. De esta forma vea que 

\begin{align*}
\langle x+y, x+y \rangle &\le \langle x,x \rangle + 2\cdot \langle x, x \rangle^{1/2} \langle y, y \rangle^{1/2} + \langle y,y \rangle\\[1ex]
&= \Big( \langle x, x \rangle^{1/2} + \langle y, y \rangle^{1/2}\Big)^{2}\\[1ex]
\implies \qquad \langle x+y, x+y \rangle^{1/2} &\le  \langle x, x \rangle^{1/2} + \langle y, y \rangle^{1/2}
\end{align*}

Vea que la función $\|\cdot\| := \langle \cdot, \cdot \rangle^{1/2}$ cumple las propiedades de una norma, por lo que $\|\cdot\|$ sería la norma del espacio de pre-Hilbert $X$. Así se puede concluir que el espacio pre–Hilbert es siempre un espacio normado $\qquad\blacksquare$


:::
:::

---

::: {.callout-tip}
## Teorema 14
Sea $U$ un subespacio vectorial de un espacio de pre–Hilbert $X$.  
Un elemento $v$ es la mejor aproximación a $w \in X$ con respecto a $U$ si y solo si:

$$
\langle w - v, u \rangle = 0 \quad \forall u \in U.
$$

Es decir, si y solamente si $w - v \perp U$. Además, para cada $w \in X$ existe a lo más una única mejor aproximación con respecto a $U$.

::: {.callout-caution collapse="true"}
### Prueba
(Ejercicio)  

$\blacksquare$
:::
:::

---

::: {.callout-tip}
## Teorema 16
Sea $U$ un subespacio vectorial completo de un espacio pre–Hilbert $X$.  
Entonces para cada elemento $w \in X$ existe una única mejor aproximación con respecto a $U$.

- El operador $P : X \to U$ que le asigna a $w \in X$ su mejor aproximación es un operador lineal acotado con las siguientes propiedades:

$$
P^2 = P \quad \text{y} \quad \|P\| = 1.
$$

- Este operador se conoce como la **proyección ortogonal** de $X$ sobre $U$.

::: {.callout-caution collapse="true"}
### Prueba
(Ejercicio)  

$\blacksquare$
:::
:::

---

::: {.callout-tip}
## Ejemplo 3
El espacio vectorial $C[a,b]$ provisto con la norma  

$$
\|f\|_\infty := \max_{x \in [a,b]} |f(x)|
$$  

es un espacio de Banach.  

::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::
:::

---

::: {.callout-tip}
## Ejemplo 5
El espacio vectorial $C[a,b]$ provisto con la norma $L_2$:

$$
\|f\|_1 := \left( \int_a^b |f(x)|^2 dx \right)^2
$$  

NO es un espacio de Banach.  

::: {.callout-caution collapse="true"}
### Prueba 

Ejercicio (sug. use la misma sucesión del ejemplo 4).  

$\blacksquare$
:::
:::

---

# Ejercicio 11
::: {.callout-note}
## Instrucción

En el teorema 7, si tomamos como espacio pre–Hilbert a $\mathbb{R}^n$ con el producto punto clásico, escriba una función en R que reciba una base de un subespacio de $\mathbb{R}^n$ en una lista de listas y retorne la base ortogonal en una lista de listas, luego otra función que calcule la base ortonormal.

:::

## Solución

---

# Ejercicio 12
::: {.callout-note}
## Instrucción

Repita el ejercicio anterior usando los espacios y el producto interno del ejemplo 7.  
¿Será posible hacer una función que reciba también como parámetro el producto interno como una función de $\mathbb{R}^n \times \mathbb{R}^n$ en $\mathbb{R}$ y genere la base ortogonal y ortonormal usando este producto interno?

:::

## Solución

---

# Ejercicio 13
::: {.callout-note}
## Instrucción

En el Corolario 2, si tomamos como espacio pre–Hilbert a $\mathbb{R}^n$ con el producto punto clásico, escriba una función en R que reciba una base de un subespacio $U$ de $\mathbb{R}^n$ en una lista de listas, un vector de $\mathbb{R}^n$ y retorne en una lista la mejor aproximación a ese vector en $U$.

:::

## Solución

---

# Ejercicio 14
::: {.callout-note}
## Instrucción

Repita el ejercicio anterior usando los espacios y el producto interno del ejemplo 7.  
¿Será posible hacer una función que reciba también como parámetro el producto interno como una función de $\mathbb{R}^n \times \mathbb{R}^n$ en $\mathbb{R}$ y genere la mejor aproximación usando este producto interno?

:::

## Solución

---


# Ejercicio 15
::: {.callout-note}
## Instrucción

Pruebe que la función $f(x) = \sqrt{x+2}$ tiene un punto fijo único en $[0,7]$.

:::

## Solución

---


# Ejercicio 16
::: {.callout-note}
## Instrucción

Sea $f : X \to X$ una aplicación. Denotamos por $F_f$ el conjunto de puntos fijos de la aplicación $f$.  
Pruebe las siguientes propiedades:

  a. Sean $f, g : X \to X$ aplicaciones tales que $f \circ g = g \circ f$ entonces se tiene que:
$$
f(F_g) \subset F_g, \quad g(F_f) \subset F_f.
$$

  b. Sean $f, g : X \to X$ aplicaciones, si $F_g = \{x^*\}$ y $f \circ g = g \circ f$ entonces $F_f \neq \varnothing$.

  c. Sea $X \neq \varnothing$ y $f : X \to X$ aplicación. Si existe $n \in \mathbb{R}$ tal que $F_{f^n} = \{x^*\}$ entonces $F_f = \{x^*\}$.

  d. Sea $X \neq \varnothing$ y $f : X \to X$ aplicación. Si $F_f \neq \varnothing$ entonces $F_{f^n} \neq \varnothing$ para todo $n \in \mathbb{N}$.

  e. Sea $X \neq \varnothing$ y $f : X \to X$ aplicación sobreyectiva, supóngase que $f_d^{-1} : X \to X$ es tal que $f \circ f_d^{-1} = I_X$ y $F_{f_d^{-1}} \neq \varnothing$ entonces $F_f \neq \varnothing$.

  f. Sea $A$ un conjunto con un número impar de elementos y $f : A \to A$ tal que $f^2(x) = x$ para todo $x \in A$, se tiene entonces que $F_f \neq \varnothing$.

  g. Sea $f : \mathbb{R} \to \mathbb{R}$ con $f$ continua y acotada entonces $F_f \neq \varnothing$.

  h. Sea $f : \mathbb{R} \to \mathbb{R}$ con $f$ continua y periódica entonces $F_f \neq \varnothing$.

:::

## Solución

  a. Sean $f, g : X \to X$ aplicaciones tales que $f \circ g = g \circ f$ entonces se tiene que:
  $$
  f(F_g) \subset F_g, \quad g(F_f) \subset F_f.
  $$
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  b. Sean $f, g : X \to X$ aplicaciones, si $F_g = \{x^*\}$ y $f \circ g = g \circ f$ entonces $F_f \neq \varnothing$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  c. Sea $X \neq \varnothing$ y $f : X \to X$ aplicación. Si existe $n \in \mathbb{R}$ tal que $F_{f^n} = \{x^*\}$ entonces $F_f = \{x^*\}$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  d. Sea $X \neq \varnothing$ y $f : X \to X$ aplicación. Si $F_f \neq \varnothing$ entonces $F_{f^n} \neq \varnothing$ para todo $n \in \mathbb{N}$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  e. Sea $X \neq \varnothing$ y $f : X \to X$ aplicación sobreyectiva, supóngase que $f_d^{-1} : X \to X$ es tal que $f \circ f_d^{-1} = I_X$ y $F_{f_d^{-1}} \neq \varnothing$ entonces $F_f \neq \varnothing$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  f. Sea $A$ un conjunto con un número impar de elementos y $f : A \to A$ tal que $f^2(x) = x$ para todo $x \in A$, se tiene entonces que $F_f \neq \varnothing$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  g. Sea $f : \mathbb{R} \to \mathbb{R}$ con $f$ continua y acotada entonces $F_f \neq \varnothing$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::

  h. Sea $f : \mathbb{R} \to \mathbb{R}$ con $f$ continua y periódica entonces $F_f \neq \varnothing$.
  
::: {.callout-caution collapse="true"}
### Prueba

(Ejercicio)  

$\blacksquare$
:::



